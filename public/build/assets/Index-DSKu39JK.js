import{d as N,D as w,E as V,c as _,a as s,u as e,h as P,w as a,b as n,g as d,j as p,e as v,o as r,F as y,r as $,t as i,n as U,C as D}from"./app-DKNlRC1F.js";import{_ as z}from"./AppLayout.vue_vue_type_script_setup_true_lang-unBaKQbx.js";import{d as M}from"./index-C4J_hXM0.js";import{_ as B,a as E,b as S,c as m,d as R,e as f}from"./TableHeader.vue_vue_type_script_setup_true_lang-DzTU3N0Z.js";import{_ as q,a as L,b as H,c as K,d as Q,e as G}from"./SelectValue.vue_vue_type_script_setup_true_lang-C0h_AdGr.js";import{_ as J,E as W}from"./index-Gk-48Nu3.js";import{_ as x}from"./index-BQxCho7n.js";import{_ as X,a as Y,b as Z,c as ee,d as te}from"./DialogTitle.vue_vue_type_script_setup_true_lang-hhEH7dWV.js";import{_ as se,a as ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BtNvFY82.js";import{_ as ne}from"./Label.vue_vue_type_script_setup_true_lang-B1hMgyir.js";import{c as j}from"./createLucideIcon-CRI9sgHw.js";import"./index-BLxJ2rd3.js";import"./VisuallyHidden-C_0I7hT2.js";import"./useForwardExpose-D6BABUKN.js";import"./useForwardPropsEmits-DxjusBnZ.js";import"./users-YngmRZu8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./check-CrPUuMOw.js";import"./useFormControl-C9_oxDCL.js";const le=j("FilterIcon",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const C=j("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ie={class:"flex h-full flex-1 flex-col gap-10 overflow-x-auto p-10"},de={class:"flex items-center justify-between"},oe={class:"flex items-center gap-3"},re={class:"rounded-2xl border border-border bg-card shadow-sm p-4"},ue={class:"font-medium text-foreground text-sm"},ce={class:"text-xs text-muted-foreground"},me={class:"font-medium text-foreground text-sm"},fe=["title"],_e={key:0,class:"flex items-center gap-2"},ge={class:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30"},xe={class:"text-xs font-semibold text-blue-700 dark:text-blue-400"},pe={class:"text-sm"},be={key:1,class:"text-sm text-muted-foreground italic"},ve={class:"text-sm"},ye={class:"font-medium text-foreground"},he={class:"text-xs text-muted-foreground"},ke={class:"flex items-center justify-end gap-2"},we={key:0,class:"border-t border-border p-4 flex items-center justify-between text-sm text-muted-foreground"},$e={class:"flex items-center gap-2"},De={class:"px-3"},Se={class:"grid gap-6 py-4"},Ce={class:"rounded-lg bg-muted p-4"},je={class:"text-sm space-y-2"},Ae={class:"flex justify-between"},Fe={class:"font-medium"},Oe={class:"flex justify-between"},Te={class:"font-medium"},Ie={class:"flex justify-between"},Ne={class:"font-medium"},Ve={class:"grid gap-3"},Pe={class:"flex items-center gap-2"},Ue={class:"flex h-6 w-6 items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/30"},ze={class:"text-xs font-semibold text-blue-700 dark:text-blue-400"},Me={key:0,class:"text-sm text-red-500"},it=N({__name:"Index",props:{orders:{},technicians:{}},setup(o){const b=w(!1),c=w(null),u=V({technician_id:""}),A=[{title:"Dashboard",href:M().url},{title:"All Orders",href:"/admin/orders"}],h={submitted:{label:"Submitted",class:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},under_review:{label:"Under Review",class:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"},in_production:{label:"In Production",class:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400"},quality_check:{label:"Quality Check",class:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400"},ready_for_delivery:{label:"Ready",class:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},completed:{label:"Completed",class:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}},k=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),F=g=>{const t=Math.ceil((new Date(g).getTime()-new Date().getTime())/864e5);return t>0?`${t} days`:"Overdue"},O=g=>{c.value=g,u.technician_id=g.technician?.id?.toString()||"",b.value=!0},T=()=>{c.value&&u.post(`/admin/orders/${c.value.id}/assign-technician`,{onSuccess:()=>{b.value=!1,u.reset(),c.value=null}})};return(g,t)=>(r(),_(y,null,[s(e(P),{title:"Admin Orders"}),s(z,{breadcrumbs:A},{default:a(()=>[n("div",ie,[n("div",de,[t[4]||(t[4]=n("div",null,[n("h1",{class:"text-3xl font-bold text-foreground"},"All Orders"),n("p",{class:"text-muted-foreground mt-1"}," Manage and assign orders to technicians ")],-1)),n("div",oe,[s(e(x),{variant:"outline",class:"gap-2"},{default:a(()=>[s(e(le),{class:"h-4 w-4"}),t[3]||(t[3]=d(" Filter ",-1))]),_:1})])]),n("div",re,[s(e(B),null,{default:a(()=>[o.orders.data.length===0?(r(),v(e(q),{key:0},{default:a(()=>[...t[5]||(t[5]=[d(" No orders found. ",-1)])]),_:1})):p("",!0),s(e(E),null,{default:a(()=>[s(e(S),null,{default:a(()=>[s(e(m),{class:"w-[50px]"},{default:a(()=>[...t[6]||(t[6]=[d("#",-1)])]),_:1}),s(e(m),{class:"w-[120px]"},{default:a(()=>[...t[7]||(t[7]=[d("Order ID",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[8]||(t[8]=[d("Client",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[9]||(t[9]=[d("Service",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[10]||(t[10]=[d("Status",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[11]||(t[11]=[d("Technician",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[12]||(t[12]=[d("Due Date",-1)])]),_:1}),s(e(m),null,{default:a(()=>[...t[13]||(t[13]=[d("Price",-1)])]),_:1}),s(e(m),{class:"text-right"},{default:a(()=>[...t[14]||(t[14]=[d("Actions",-1)])]),_:1})]),_:1})]),_:1}),s(e(R),null,{default:a(()=>[(r(!0),_(y,null,$(o.orders.data,(l,I)=>(r(),v(e(S),{key:l.id,class:"hover:bg-muted/50 transition-colors"},{default:a(()=>[s(e(f),{class:"font-medium text-muted-foreground"},{default:a(()=>[d(i(I+1),1)]),_:2},1024),s(e(f),{class:"font-medium font-mono text-sm"},{default:a(()=>[d(i(l.order_number),1)]),_:2},1024),s(e(f),null,{default:a(()=>[n("div",null,[n("div",ue,i(l.client.name),1),n("div",ce,i(l.client.email),1)])]),_:2},1024),s(e(f),null,{default:a(()=>[n("div",null,[n("div",me,i(l.service.name),1),l.special_instructions?(r(),_("div",{key:0,class:"text-xs text-muted-foreground mt-1 truncate max-w-[200px]",title:l.special_instructions},i(l.special_instructions),9,fe)):p("",!0)])]),_:2},1024),s(e(f),null,{default:a(()=>[s(e(J),{class:U([h[l.status].class,"text-xs"]),variant:"secondary"},{default:a(()=>[d(i(h[l.status].label),1)]),_:2},1032,["class"])]),_:2},1024),s(e(f),null,{default:a(()=>[l.technician?(r(),_("div",_e,[n("div",ge,[n("span",xe,i(l.technician.name.charAt(0)),1)]),n("span",pe,i(l.technician.name),1)])):(r(),_("span",be," Not assigned "))]),_:2},1024),s(e(f),null,{default:a(()=>[n("div",ve,[n("div",ye,i(k(l.due_date)),1),n("div",he,i(F(l.due_date)),1)])]),_:2},1024),s(e(f),{class:"font-semibold text-foreground text-sm"},{default:a(()=>[d(" Ksh "+i(parseFloat(l.service.base_price).toFixed(2)),1)]),_:2},1024),s(e(f),{class:"text-right"},{default:a(()=>[n("div",ke,[s(e(x),{variant:"default",size:"sm",class:"gap-2",onClick:Be=>O(l)},{default:a(()=>[s(e(C),{class:"h-4 w-4"}),d(" "+i(l.technician?"Reassign":"Assign"),1)]),_:2},1032,["onClick"]),s(e(x),{variant:"ghost",size:"sm"},{default:a(()=>[s(e(W),{class:"h-4 w-4"})]),_:1})])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o.orders.data.length>0?(r(),_("div",we,[n("div",null," Showing "+i((o.orders.current_page-1)*o.orders.per_page+1)+" to "+i(Math.min(o.orders.current_page*o.orders.per_page,o.orders.total))+" of "+i(o.orders.total)+" orders ",1),n("div",$e,[s(e(x),{variant:"outline",size:"sm",disabled:o.orders.current_page===1},{default:a(()=>[...t[15]||(t[15]=[d(" Previous ",-1)])]),_:1},8,["disabled"]),n("span",De,"Page "+i(o.orders.current_page)+" of "+i(o.orders.last_page),1),s(e(x),{variant:"outline",size:"sm",disabled:o.orders.current_page===o.orders.last_page},{default:a(()=>[...t[16]||(t[16]=[d(" Next ",-1)])]),_:1},8,["disabled"])])])):p("",!0)]),s(e(X),{open:b.value,"onUpdate:open":t[2]||(t[2]=l=>b.value=l)},{default:a(()=>[s(e(Y),{class:"sm:max-w-[425px]",onInteractOutside:t[1]||(t[1]=D(()=>{},["prevent"]))},{default:a(()=>[n("form",{onSubmit:D(T,["prevent"])},[s(e(Z),null,{default:a(()=>[s(e(ee),null,{default:a(()=>[...t[17]||(t[17]=[d("Assign Technician",-1)])]),_:1}),s(e(te),null,{default:a(()=>[d(" Select a technician to assign to order "+i(c.value?.order_number),1)]),_:1})]),_:1}),n("div",Se,[n("div",Ce,[n("div",je,[n("div",Ae,[t[18]||(t[18]=n("span",{class:"text-muted-foreground"},"Client:",-1)),n("span",Fe,i(c.value?.client.name),1)]),n("div",Oe,[t[19]||(t[19]=n("span",{class:"text-muted-foreground"},"Service:",-1)),n("span",Te,i(c.value?.service.name),1)]),n("div",Ie,[t[20]||(t[20]=n("span",{class:"text-muted-foreground"},"Due Date:",-1)),n("span",Ne,i(c.value?k(c.value.due_date):""),1)])])]),n("div",Ve,[s(e(ne),{for:"technician"},{default:a(()=>[...t[21]||(t[21]=[d("Technician *",-1)])]),_:1}),s(e(L),{modelValue:e(u).technician_id,"onUpdate:modelValue":t[0]||(t[0]=l=>e(u).technician_id=l),required:""},{default:a(()=>[s(e(H),{id:"technician"},{default:a(()=>[s(e(K),{placeholder:"Select a technician"})]),_:1}),s(e(Q),null,{default:a(()=>[(r(!0),_(y,null,$(o.technicians,l=>(r(),v(e(G),{key:l.id,value:l.id.toString()},{default:a(()=>[n("div",Pe,[n("div",Ue,[n("span",ze,i(l.name.charAt(0)),1)]),n("span",null,i(l.name),1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(u).errors.technician_id?(r(),_("p",Me,i(e(u).errors.technician_id),1)):p("",!0)])]),s(e(se),null,{default:a(()=>[s(e(ae),{"as-child":""},{default:a(()=>[s(e(x),{variant:"outline",type:"button"},{default:a(()=>[...t[22]||(t[22]=[d(" Cancel ",-1)])]),_:1})]),_:1}),s(e(x),{type:"submit",disabled:e(u).processing},{default:a(()=>[e(u).processing?p("",!0):(r(),v(e(C),{key:0,class:"h-4 w-4 mr-2"})),d(" "+i(e(u).processing?"Assigning...":"Assign Technician"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{it as default};
